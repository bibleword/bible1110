<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>每日圣经</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#87CEEB">
    
    <style>
        /* --- 基础样式 --- */
        :root {
            --color-understand: #007bff;
            --color-prayer: #28a745;
            --color-connect: #6f42c1;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            color: #333;
            /* 漂亮的渐变背景，模拟天空效果 */
            background-image: linear-gradient(to bottom, #87CEEB, #B0E0E6, #FFFFFF);
            background-attachment: fixed;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* --- 页面布局 --- */
        .container {
            width: 100%;
            max-width: 600px;
            text-align: center;
        }

        h1#main-title {
            font-size: 2.2rem;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            margin-top: 20px;
            margin-bottom: 5px;
        }

        #beijing-time {
            font-size: 0.9rem;
            color: #f8f9fa;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 2px 8px;
            border-radius: 12px;
            display: inline-block;
            margin-bottom: 30px;
        }

        /* --- 毛玻璃效果 --- */
        .glass-box {
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px) saturate(180%);
            -webkit-backdrop-filter: blur(10px) saturate(180%);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        /* --- 内容区域 --- */
        .content-card {
            padding: 25px;
            text-align: left;
            margin-bottom: 30px;
        }

        #bible-text {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #000;
        }

        #bible-ref {
            font-size: 1rem;
            font-weight: bold;
            text-align: right;
            margin-top: 20px;
            color: #333;
        }

        /* --- 按钮区域 --- */
        .button-group {
            display: flex;
            justify-content: space-between;
        }

        .action-button {
            flex: 1;
            margin: 0 8px;
            padding: 12px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        #btn-understand { color: var(--color-understand); }
        #btn-prayer { color: var(--color-prayer); }
        #btn-connect { color: var(--color-connect); }

        /* --- 弹窗 Modal --- */
        .modal {
            display: none; /* 默认隐藏 */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5); /* 半透明遮罩 */
            animation: fadeIn 0.3s;
        }

        .modal-content {
            position: relative;
            background-color: #fefefe;
            margin: 15% auto;
            padding: 30px;
            border: 1px solid #888;
            width: 80%;
            max-width: 500px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            animation: slideIn 0.3s;
        }

        .close-btn {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: black;
        }

        #modal-title {
            margin-top: 0;
            font-size: 1.5rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        #modal-body {
            font-size: 1rem;
            line-height: 1.7;
            white-space: pre-wrap; /* 保留换行符 */
        }

        /* 交流信息样式 */
        #modal-body p {
            margin: 10px 0;
        }
        #modal-body a {
            color: #007bff;
            text-decoration: none;
        }
        #modal-body a:hover {
            text-decoration: underline;
        }

        /* 动画 */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

    </style>
</head>
<body>

    <div class="container">
        <h1 id="main-title">加载中...</h1>
        
        <div id="beijing-time"></div>

        <div class="content-card glass-box">
            <p id="bible-text">加载中...</p>
            <p id="bible-ref">加载中...</p>
        </div>

        <div class="button-group">
            <button id="btn-understand" class="action-button glass-box">理解</button>
            <button id="btn-prayer" class="action-button glass-box">祷告</button>
            <button id="btn-connect" class="action-button glass-box">交流</button>
        </div>
    </div>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2 id="modal-title"></h2>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        // --- PWA Service Worker 注册 ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('ServiceWorker 注册成功: ', registration.scope);
                    })
                    .catch(error => {
                        console.log('ServiceWorker 注册失败: ', error);
                    });
            });
        }

        // --- 核心数据 ---
        // TODO: 在这里添加您的数据
        // 这是您添加和更新内容的地方。
        // 格式: { title: "标题", text: "圣经内容", ref: "出处", think: "理解内容", prayer: "祷告内容" },
        // (请确保 "think" 和 "prayer" 内容中的换行符使用 \n 代替)
        const dailyData = [
            // 这是第 1 天 (dayOfYear = 1)
            { 
                title: "主里新身份", 
                text: "你看父赐给我们是何等的慈爱！", 
                ref: "约翰一书3章1节", 
                think: "“我不再是从前的我了，现在的我是新造的人。”这是我儿子杰夫在一次学校集会上，向学生们描述上帝在他生命中的改变。\n\n杰夫曾是个海洛因成瘾者，他从前是以所犯的罪和错误来看待自己，但现在他视自己为上帝的儿女。\n\n圣经也用此应许来激励我们...", 
                prayer: "亲爱的天父，感谢祢如此爱我，甚至称我为祢的儿女。\n求祢帮助我，活出祢儿女的样式，能荣耀祢的名。" 
            },
            // 这是第 2 天
            { 
                title: "第2天标题", 
                text: "第2天圣经内容...", 
                ref: "出处", 
                think: "第2天“今日理解”的内容。\n可以换行。", 
                prayer: "第2天“祷告指引”的内容。\n也可以换行。" 
            },
            // 这是第 3 天
            { 
                title: "第3天标题", 
                text: "第3天圣经内容...", 
                ref: "出处", 
                think: "第3天“今日理解”的内容。", 
                prayer: "第3天“祷告指引”的内容。" 
            },
            // 这是第 4 天
            { 
                title: "第4天标题", 
                text: "第4天圣经内容...", 
                ref: "出处", 
                think: "第4天“今日理解”的内容。", 
                prayer: "第4天“祷告指引”的内容。" 
            },
            // 这是第 5 天
            { 
                title: "第5天标题", 
                text: "第5天圣经内容...", 
                ref: "出处", 
                think: "第5天“今日理解”的内容。", 
                prayer: "第5天“祷告指引”的内容。" 
            },
            // 这是第 6 天
            { 
                title: "第6天标题", 
                text: "第6天圣经内容...", 
                ref: "出处", 
                think: "第6天“今日理解”的内容。", 
                prayer: "第6天“祷告指引”的内容。" 
            },
            // 这是第 7 天
            { 
                title: "第7天标题", 
                text: "第7天圣经内容...", 
                ref: "出处", 
                think: "第7天“今日理解”的内容。", 
                prayer: "第7天“祷告指引”的内容。" 
            },
            // 这是第 8 天
            { 
                title: "第8天标题", 
                text: "第8天圣经内容...", 
                ref: "出处", 
                think: "第8天“今日理解”的内容。", 
                prayer: "第8天“祷告指引”的内容。" 
            },
            // 这是第 9 天
            { 
                title: "第9天标题", 
                text: "第9天圣经内容...", 
                ref: "出处", 
                think: "第9天“今日理解”的内容。", 
                prayer: "第9天“祷告指引”的内容。" 
            },
            // 这是第 10 天
            { 
                title: "第10天标题", 
                text: "第10天圣经内容...", 
                ref: "出处", 
                think: "第10天“今日理解”的内容。", 
                prayer: "第10天“祷告指引”的内容。" 
            }
            // ... 在这里继续添加第 11 天, 第 12 天... 直到 365 天
        ];

        // --- 获取元素 ---
        const titleEl = document.getElementById('main-title');
        const timeEl = document.getElementById('beijing-time');
        const textEl = document.getElementById('bible-text');
        const refEl = document.getElementById('bible-ref');
        
        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalBody = document.getElementById('modal-body');
        const closeBtn = document.getElementsByClassName('close-btn')[0];

        const btnUnderstand = document.getElementById('btn-understand');
        const btnPrayer = document.getElementById('btn-prayer');
        const btnConnect = document.getElementById('btn-connect');
        
        let currentData = {};

        // --- 功能函数 ---

        // 1. 更新北京时间
        function updateBeijingTime() {
            const options = {
                timeZone: 'Asia/Shanghai', // 北京时间 (东八区)
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            };
            const beijingTime = new Date().toLocaleString('zh-CN', options);
            timeEl.textContent = `北京时间 ${beijingTime}`;
        }

        // 2. 获取一年中的第几天 (1-366)
        function getDayOfYear() {
            const now = new Date();
            const start = new Date(now.getFullYear(), 0, 0);
            const diff = now - start;
            const oneDay = 1000 * 60 * 60 * 24;
            const day = Math.floor(diff / oneDay);
            return day;
        }

        // 3. 更新每日内容
        function updateDailyContent() {
            const dayOfYear = getDayOfYear();
            // 使用取余运算 (%) 来循环数据
            // (dayOfYear - 1) 确保1月1日对应数组的第0项
            const dataIndex = (dayOfYear - 1) % dailyData.length;
            
            currentData = dailyData[dataIndex];

            titleEl.textContent = currentData.title;
            textEl.textContent = currentData.text;
            refEl.textContent = `—— ${currentData.ref}`;
        }

        // 4. 打开弹窗
        function openModal(type) {
            if (type === 'understand') {
                modalTitle.textContent = '今日理解';
                modalTitle.style.color = 'var(--color-understand)';
                modalBody.textContent = currentData.think;
            } else if (type === 'prayer') {
                modalTitle.textContent = '祷告指引';
                modalTitle.style.color = 'var(--color-prayer)';
                modalBody.textContent = currentData.prayer;
            } else if (type === 'connect') {
                modalTitle.textContent = '交流联系';
                modalTitle.style.color = 'var(--color-connect)';
                modalBody.innerHTML = `
                    <p>我们很乐意与您交流和代祷！
                    <p><strong>邮箱:</strong> <a href="mailto:juvan0926@gmail.com">juvan0926@gmail.com</a>
                    <p><strong>微信:</strong> 18968860469</p>
                    <p><strong>淘宝:</strong> <a href="https://m.tb.cn/h.Sr7xvEYKyFQt6jo" target="_blank">点击访问</a>
                    <p><strong>小红书:</strong> <a href="https://xhslink.com/m/4AgROk2mC4" target="_blank">点击访问</a>
                `;
            }
            modal.style.display = 'block';
        }

        // 5. 关闭弹窗
        function closeModal() {
            modal.style.display = 'none';
        }

        // --- 事件监听 ---
        btnUnderstand.addEventListener('click', () => openModal('understand'));
        btnPrayer.addEventListener('click', () => openModal('prayer'));
        btnConnect.addEventListener('click', () => openModal('connect'));

        closeBtn.addEventListener('click', closeModal);
        window.addEventListener('click', (event) => {
            if (event.target == modal) {
                closeModal();
            }
        });

        // --- 页面初始化 ---
        updateDailyContent();
        updateBeijingTime();
        // 每秒更新一次时间
        setInterval(updateBeijingTime, 1000);

    </script>
</body>
</html>
